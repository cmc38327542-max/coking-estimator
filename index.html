<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>아파트 창틀 실리콘 코킹 예상 비용 가이드</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#101722;
      --card2:#0f1620;
      --text:#eaf1ff;
      --muted:#a9b6cc;
      --line:#1f2a3a;
      --accent:#4ea1ff;
      --accent2:#7bdfff;
      --danger:#ff5d5d;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --r:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
      background: radial-gradient(1200px 900px at 20% 0%, rgba(78,161,255,.18), transparent 55%),
                  radial-gradient(900px 700px at 90% 10%, rgba(123,223,255,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    .wrap{width:min(980px, 92vw); margin:0 auto;}
    .topbar{
      position:sticky; top:0; z-index:10;
      background: rgba(11,15,20,.78);
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(31,42,58,.8);
    }
    .title{font-weight:800; letter-spacing:-.02em; padding:14px 0 6px; font-size:16px;}
    .sub{padding:0 0 12px; color:var(--muted); font-size:12px; line-height:1.4;}

    .card{
      background: linear-gradient(180deg, rgba(16,23,34,.95), rgba(15,22,32,.92));
      border:1px solid rgba(31,42,58,.8);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding:16px;
      margin:16px 0;
    }

    .progress__label{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      color:var(--muted); font-size:12px; margin-bottom:10px;
    }
    .progress__bar{
      width:100%; height:10px; border-radius:999px;
      background: rgba(31,42,58,.7); overflow:hidden;
    }
    .progress__fill{
      height:100%; width:0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border-radius:999px; transition: width .25s ease;
    }

    .link{
      border:none; background: transparent;
      color: var(--accent2); font-weight:700;
      padding:6px 8px; border-radius:10px;
    }
    .link:active{transform: translateY(1px);}

    .qTitle{margin:12px 0 6px; font-size:18px; letter-spacing:-.02em;}
    .qHint{margin:0 0 12px; color:var(--muted); font-size:13px; line-height:1.45;}

    .options{display:grid; gap:10px;}
    .opt{
      width:100%;
      text-align:left;
      border:1px solid rgba(31,42,58,.9);
      background: rgba(10,14,20,.3);
      color:var(--text);
      padding:14px 14px;
      border-radius:16px;
      font-weight:800;
      font-size:15px;
      letter-spacing:-.01em;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
    }
    .opt small{
      display:block; margin-top:6px;
      color:var(--muted); font-weight:600;
      font-size:12px; line-height:1.35;
    }
    .opt .tag{
      flex:0 0 auto;
      font-size:12px;
      font-weight:900;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(31,42,58,.9);
      color:var(--muted);
    }
    .opt--selected{
      border-color: rgba(78,161,255,.9);
      box-shadow: 0 0 0 4px rgba(78,161,255,.12);
      background: rgba(78,161,255,.08);
    }
    .opt:active{transform: translateY(1px);}

    .nav{display:flex; gap:10px; margin-top:14px;}
    .btn{
      width:100%;
      border:none;
      padding:14px 14px;
      border-radius:16px;
      font-weight:900;
      font-size:15px;
      letter-spacing:-.01em;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      color:#07101a;
      cursor:pointer;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .btn:disabled{opacity:.45; cursor:not-allowed;}
    .btn--ghost{
      background: transparent;
      color: var(--text);
      border:1px solid rgba(31,42,58,.9);
    }
    .btn:active,.btn--ghost:active{transform: translateY(1px);}

    .guard{
      margin-top:14px;
      border:1px solid rgba(255,93,93,.45);
      background: rgba(255,93,93,.10);
      color: #ffd6d6;
      padding:12px 12px;
      border-radius:14px;
      font-size:13px;
      line-height:1.45;
    }

    .summary{position:sticky; bottom:10px; padding-bottom:14px;}
    @media (min-width: 900px){
      main.wrap{display:grid; grid-template-columns: 1.05fr .95fr; gap:16px; align-items:start;}
      .summary{position:sticky; top:86px; bottom:auto;}
    }

    .summary__head{display:flex; align-items:flex-start; justify-content:space-between; gap:12px;}
    .summary__title{font-weight:900; letter-spacing:-.02em; font-size:14px;}
    .summary__mini{text-align:right; color:var(--muted); font-size:12px; line-height:1.35; max-width:62%;}
    .divider{height:1px; background: rgba(31,42,58,.9); margin:12px 0;}

    .priceBox{
      background: rgba(10,14,20,.22);
      border:1px solid rgba(31,42,58,.75);
      border-radius:16px;
      padding:12px;
    }
    .priceBox__row{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:8px 0;}
    .muted{color:var(--muted); font-size:12px;}
    .mutedRight{color:var(--muted); font-size:12px; text-align:right;}
    .price{font-weight:950; font-size:14px;}
    .price--range{font-size:16px;}
    .fineprint{margin-top:10px; color:var(--muted); font-size:11px; line-height:1.45;}

    .ctaRow{display:flex; gap:10px; margin-top:12px;}
    .details{
      margin-top:10px;
      border:1px solid rgba(31,42,58,.75);
      border-radius:16px;
      padding:10px 12px;
      background: rgba(10,14,20,.18);
    }
    .details summary{cursor:pointer; font-weight:900; font-size:13px;}
    .details__body{margin-top:10px; color:var(--muted); font-size:12px; line-height:1.55;}
    .footer{padding:20px 0 28px; text-align:center;}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <div class="title">아파트 창틀 실리콘 코킹 예상 비용 가이드</div>
      <div class="sub">
        상담 전 참고용 가격 가이드입니다. 정확한 시공 가능 여부 및 금액은 사진 확인 후 결정되며, 현장 상황에 따라 시공이 어려울 수 있습니다.
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="progress">
        <div class="progress__label">
          <span id="stepLabel">1 / 8</span>
          <button id="resetBtn" class="link" type="button">처음부터</button>
        </div>
        <div class="progress__bar"><div id="progressFill" class="progress__fill"></div></div>
      </div>

      <h2 id="qTitle" class="qTitle">질문</h2>
      <p id="qHint" class="qHint"></p>

      <div id="options" class="options"></div>

      <div class="nav">
        <button id="prevBtn" class="btn btn--ghost" type="button">이전</button>
        <button id="nextBtn" class="btn" type="button" disabled>다음</button>
      </div>

      <div id="guardBox" class="guard" hidden></div>
    </section>

    <section class="card summary">
      <div class="summary__head">
        <div class="summary__title">선택 요약</div>
        <div id="summaryMini" class="summary__mini">아직 선택 전</div>
      </div>

      <div class="divider"></div>

      <div class="priceBox">
        <div class="priceBox__row">
          <div class="muted">평형 기준 금액(가이드)</div>
          <div id="basePrice" class="price">-</div>
        </div>
        <div class="priceBox__row">
          <div class="muted">추가 작업 가능성</div>
          <div id="addNote" class="mutedRight">-</div>
        </div>
        <div class="priceBox__row">
          <div class="muted">예상 범위(참고)</div>
          <div id="rangePrice" class="price price--range">-</div>
        </div>
        <div class="fineprint">
          ※ 최종 금액/시공 여부는 사진 확인 후 안내됩니다. 예상 견적이 나왔다고 해서 반드시 시공을 약속드리지는 않습니다.
        </div>
      </div>

      <div class="ctaRow">
        <button id="copyBtn" class="btn btn--ghost" type="button">상담 예시 복사</button>
        <a id="kakaoBtn" class="btn" href="#" target="_blank" rel="noopener">사진 보내기</a>
      </div>

      <details class="details">
        <summary>시공 방식 안내</summary>
        <div class="details__body">
          본 시공은 외벽 로프 작업으로만 진행됩니다.<br/>
          - 덧방 시공은 진행하지 않습니다.<br/>
          - 그라인더 기계 연마 방식은 사용하지 않습니다.<br/><br/>
          수공구 기준<br/>
          ▶ 99% 올제거 + 80% 제거 혼합 방식으로 피착면 정리를 우선하며,<br/>
          예상 수명은 약 7 ~ 10년입니다.
        </div>
      </details>

      <details class="details">
        <summary>개별 시공 항목(선택)</summary>
        <div class="details__body">
          - 크랙 보수 : 40 ~ 70만원<br/>
          - 거실창 단독 : 35 ~ 40만원<br/>
          - 안방창 단독 : 30 ~ 35만원<br/>
          - 작은방 창 : 25 ~ 30만원
        </div>
      </details>
    </section>
  </main>

  <footer class="wrap footer">
    <span class="muted">© 예상 비용 가이드 · 모바일 최적화</span>
  </footer>

  <script>
    const STORAGE_KEY = "coking_estimator_single_v1";
    const W = (n) => new Intl.NumberFormat("ko-KR").format(n) + "원";

    // ✅ 여기만 네 카톡 채널 링크로 바꾸면 됨 (예: https://pf.kakao.com/_xlCxixon/chat)
    const KAKAO_CHAT_URL = "https://pf.kakao.com/_xlCxixon/chat";

document.getElementById("kakaoBtn").addEventListener("click", function (e) {
  e.preventDefault();

  const appLink = "kakaotalk://pf/chat?channelPublicId=_xlCxixon";
  const webLink = "https://pf.kakao.com/_xlCxixon/chat";

  // 앱 먼저 시도
  location.href = appLink;

  // 앱이 없으면 1초 후 웹으로
  setTimeout(() => {
    location.href = webLink;
  }, 800);
});


    const areaTable = [
      { label: "25평대", area: 25, per: 25000, total: 625000 },
      { label: "35평대", area: 35, per: 24000, total: 840000 },
      { label: "45평대", area: 45, per: 23000, total: 1035000 },
      { label: "55평대", area: 55, per: 22000, total: 1210000 },
    ];

    const steps = [
      {
        key: "region",
        title: "1) 시공 지역",
        hint: "대구/경산만 진행합니다. 기타 지역은 시공이 어렵습니다.",
        options: [
          { value: "대구", text: "대구", tag: "가능" },
          { value: "경산", text: "경산", tag: "가능" },
          { value: "기타", text: "기타 지역", tag: "불가", danger: true, note: "대구/경산 외 지역은 시공이 어렵습니다." },
        ],
        guard: (ans) => (ans === "기타" ? "대구/경산 외 지역은 시공이 어렵습니다." : null),
      },
      {
        key: "year",
        title: "2) 아파트 준공 연도",
        hint: "노후 아파트는 보수 범위가 확대될 수 있어요.",
        options: [
          { value: "1990~2003", text: "1990 ~ 2003년", tag: "노후", note: "노후화로 보수 범위 확대 가능" },
          { value: "2004~2015", text: "2004 ~ 2015년", tag: "일반" },
        ],
      },
      {
        key: "window",
        title: "3) 샷시 종류",
        hint: "샷시 종류에 따라 작업 난이도가 달라질 수 있습니다.",
        options: [
          { value: "알루미늄", text: "알루미늄 샷시", tag: "" },
          { value: "PVC", text: "하이샷시 (PVC)", tag: "" },
        ],
      },
      {
        key: "buildingFloors",
        title: "4) 아파트 전체 층수 (로프 기준)",
        hint: "전체 층수(최고층)가 작업 난이도에 가장 영향이 큽니다.",
        options: [
          { value: "15이하", text: "15층 이하", tag: "" },
          { value: "16~20", text: "16 ~ 20층", tag: "" },
          { value: "21~25", text: "21 ~ 25층", tag: "" },
          { value: "26이상", text: "26층 이상", tag: "불가", danger: true, note: "26층 이상은 시공이 어렵습니다." },
        ],
        guard: (ans) => (ans === "26이상" ? "26층 이상(최고층 기준)은 시공이 어렵습니다." : null),
      },
      {
        key: "unitPos",
        title: "5) 해당 세대 위치",
        hint: "세대 위치(저층/중간/탑층 인접)를 선택해주세요.",
        options: [
          { value: "저층", text: "저층 (1 ~ 5층)", tag: "" },
          { value: "중간층", text: "중간층", tag: "" },
          { value: "탑층인접", text: "탑층 또는 탑층 인접", tag: "" },
        ],
      },
      {
        key: "areaBand",
        title: "6) 평형 선택",
        hint: "평형이 커질수록 평당 단가는 자동 조정됩니다.",
        options: areaTable.map((r) => ({
          value: r.label,
          text: r.label,
          tag: `${Math.round(r.total / 10000)}만원대`,
          note: `가이드 금액: ${W(r.total)} (평당 ${W(r.per)})`,
        })),
      },
      {
        key: "leakPos",
        title: "7) 누수/증상 위치",
        hint: "현재 가장 문제가 되는 위치를 선택해주세요.",
        options: [
          { value: "우리집천장", text: "우리집 천장", tag: "" },
          { value: "우리집바닥", text: "우리집 바닥", tag: "" },
          { value: "아랫집천장", text: "아랫집 천장", tag: "" },
        ],
      },
      {
        key: "history",
        title: "8) 실리콘 시공 이력",
        hint: "기존 코킹이 여러 번 되어 있으면 추가 작업 가능성이 있습니다.",
        options: [
          { value: "준공그대로", text: "준공 상태 그대로", tag: "" },
          { value: "1회", text: "코킹 시공 1회 있음", tag: "+", note: "추가 작업 가능성" },
          { value: "2회이상", text: "코킹 시공 2회 이상 있음", tag: "++", note: "추가 작업 가능성(높음)" },
        ],
      },
    ];

    const state = { step: 0, answers: {} };

    const stepLabel = document.getElementById("stepLabel");
    const progressFill = document.getElementById("progressFill");
    const qTitle = document.getElementById("qTitle");
    const qHint = document.getElementById("qHint");
    const optionsEl = document.getElementById("options");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const resetBtn = document.getElementById("resetBtn");
    const guardBox = document.getElementById("guardBox");

    const summaryMini = document.getElementById("summaryMini");
    const basePrice = document.getElementById("basePrice");
    const addNote = document.getElementById("addNote");
    const rangePrice = document.getElementById("rangePrice");
    const copyBtn = document.getElementById("copyBtn");

    function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
    function loadState(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      try{
        const parsed = JSON.parse(raw);
        if(parsed && typeof parsed === "object"){
          state.step = Number.isInteger(parsed.step) ? parsed.step : 0;
          state.answers = parsed.answers && typeof parsed.answers === "object" ? parsed.answers : {};
        }
      }catch{}
    }

    function setGuard(message){
      if(message){
        guardBox.hidden = false;
        guardBox.textContent = message;
      }else{
        guardBox.hidden = true;
        guardBox.textContent = "";
      }
    }

    function currentStep(){ return steps[state.step]; }
    function answerForStep(stepKey){ return state.answers[stepKey] ?? null; }

    function formatMiniSummary(){
      const a = state.answers;
      const parts = [];
      if(a.region) parts.push(a.region);
      if(a.year) parts.push(a.year.replace("~", " ~ "));
      if(a.buildingFloors) parts.push(a.buildingFloors);
      if(a.areaBand) parts.push(a.areaBand);
      return parts.length ? parts.join(" · ") : "아직 선택 전";
    }

    function getAreaRow(){
      const label = state.answers.areaBand;
      if(!label) return null;
      return areaTable.find(r => r.label === label) ?? null;
    }

    function computeAddRange(){
      let min = 0, max = 0;
      if(state.answers.year === "1990~2003"){ min += 50000; max += 100000; }
      if(state.answers.history === "1회"){ min += 50000; max += 80000; }
      else if(state.answers.history === "2회이상"){ min += 80000; max += 120000; }
      if(state.answers.buildingFloors === "21~25"){ min += 30000; max += 60000; }
      else if(state.answers.buildingFloors === "16~20"){ min += 10000; max += 30000; }
      if(state.answers.unitPos === "탑층인접"){ min += 10000; max += 30000; }
      return { min, max };
    }

    function updatePriceBox(){
      summaryMini.textContent = formatMiniSummary();
      const row = getAreaRow();
      if(!row){
        basePrice.textContent = "-";
        addNote.textContent = "-";
        rangePrice.textContent = "-";
        return;
      }

      basePrice.textContent = `${W(row.total)} (가이드)`;
      const add = computeAddRange();
      addNote.textContent = (add.min === 0 && add.max === 0)
        ? "추가 없음(가이드)"
        : `+ ${Math.round(add.min/10000)} ~ ${Math.round(add.max/10000)}만원 가능`;

      const minTotal = row.total + add.min;
      const maxTotal = row.total + add.max;
      rangePrice.textContent = `${Math.round(minTotal/10000)} ~ ${Math.round(maxTotal/10000)}만원대`;

      const guardMsg =
        (state.answers.region === "기타") ? "대구/경산 외 지역은 시공이 어렵습니다."
        : (state.answers.buildingFloors === "26이상") ? "26층 이상(최고층 기준)은 시공이 어렵습니다."
        : null;
      setGuard(guardMsg);
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function render(){
      const s = currentStep();
      const totalSteps = steps.length;

      stepLabel.textContent = `${state.step + 1} / ${totalSteps}`;
      progressFill.style.width = `${((state.step + 1) / totalSteps) * 100}%`;

      qTitle.textContent = s.title;
      qHint.textContent = s.hint ?? "";

      optionsEl.innerHTML = "";
      const selected = answerForStep(s.key);

      for(const opt of s.options){
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "opt" + (selected === opt.value ? " opt--selected" : "");
        btn.setAttribute("data-value", opt.value);

        const left = document.createElement("div");
        left.innerHTML = `<div>${escapeHtml(opt.text)}${opt.note ? `<small>${escapeHtml(opt.note)}</small>` : ""}</div>`;

        const right = document.createElement("div");
        right.className = "tag";
        if(opt.danger){
          right.style.borderColor = "rgba(255,93,93,.55)";
          right.style.color = "#ffd6d6";
        }
        right.textContent = opt.tag || "선택";

        btn.appendChild(left);
        btn.appendChild(right);

        btn.addEventListener("click", () => {
          state.answers[s.key] = opt.value;
          saveState();
          const msg = typeof s.guard === "function" ? s.guard(opt.value) : null;
          setGuard(msg);
          nextBtn.disabled = false;
          render();
          updatePriceBox();
        });

        optionsEl.appendChild(btn);
      }

      prevBtn.disabled = state.step === 0;
      nextBtn.disabled = !answerForStep(s.key);
      const guardMsg = typeof s.guard === "function" ? s.guard(selected) : null;
      setGuard(guardMsg);

      updatePriceBox();
    }

    function scrollToTopCard(){ window.scrollTo({ top: 0, behavior: "smooth" }); }
    function scrollToSummary(){
      const el = document.querySelector(".summary");
      if(el) el.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    function next(){
      if(state.step < steps.length - 1){
        state.step += 1; saveState(); render(); scrollToTopCard();
      } else {
        scrollToSummary();
      }
    }
    function prev(){
      if(state.step > 0){
        state.step -= 1; saveState(); render(); scrollToTopCard();
      }
    }
    function resetAll(){
      state.step = 0; state.answers = {}; saveState(); render(); scrollToTopCard();
    }

    function buildConsultText(){
      const a = state.answers;
      const row = getAreaRow();
      const add = computeAddRange();
      const minTotal = row ? row.total + add.min : null;
      const maxTotal = row ? row.total + add.max : null;

      const parts = [];
      parts.push("(자동견적 입력 요약)");
      if(a.region) parts.push(`- 지역: ${a.region}`);
      if(a.year) parts.push(`- 준공: ${a.year}`);
      if(a.window) parts.push(`- 샷시: ${a.window}`);
      if(a.buildingFloors) parts.push(`- 전체층수: ${a.buildingFloors}`);
      if(a.unitPos) parts.push(`- 세대위치: ${a.unitPos}`);
      if(a.areaBand) parts.push(`- 평형: ${a.areaBand}`);
      if(a.leakPos) parts.push(`- 누수위치: ${a.leakPos}`);
      if(a.history) parts.push(`- 시공이력: ${a.history}`);
      if(row && minTotal != null && maxTotal != null){
        parts.push(`- 예상범위(참고): ${Math.round(minTotal/10000)}~${Math.round(maxTotal/10000)}만원대`);
      }
      parts.push("");
      parts.push("사진(필수): 누수 위치 / 외부 실리콘 상태");
      parts.push("주소(선택): 외관·로드뷰 확인용");
      parts.push("");
      parts.push("※ 최종 금액/시공 여부는 사진 확인 후 안내됩니다.");
      return parts.join("\n");
    }

    nextBtn.addEventListener("click", next);
    prevBtn.addEventListener("click", prev);
    resetBtn.addEventListener("click", resetAll);

    copyBtn.addEventListener("click", async () => {
      const text = buildConsultText();
      try{
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = "복사 완료!";
        setTimeout(()=> (copyBtn.textContent = "상담 예시 복사"), 1200);
      }catch{
        alert("복사에 실패했습니다. 모바일 브라우저 설정을 확인해주세요.");
      }
    });

    loadState();
    render();
  </script>
</body>
</html>
